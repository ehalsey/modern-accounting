{
    "$schema": "https://github.com/Azure/data-api-builder/releases/download/v1.0.0/dab.draft.schema.json",
    "data-source": {
        "database-type": "mssql",
        "connection-string": "Server=database,1433;Database=AccountingDB;User Id=sa;Password=StrongPassword123!;TrustServerCertificate=true",
        "options": {
            "set-session-context": true
        }
    },
    "runtime": {
        "rest": {
            "enabled": true,
            "path": "/api"
        },
        "graphql": {
            "enabled": true,
            "path": "/graphql",
            "allow-introspection": true
        },
        "host": {
            "mode": "development",
            "cors": {
                "origins": [
                    "http://localhost:5173"
                ],
                "allow-credentials": true
            },
            "authentication": {
                "provider": "Simulator"
            }
        }
    },
    "entities": {
        "accounts": {
            "source": "dbo.Accounts",
            "permissions": [
                {
                    "role": "anonymous",
                    "actions": [
                        "*"
                    ]
                }
            ]
        },
        "banktransactions": {
            "source": "dbo.v_BankTransactions",
            "permissions": [
                {
                    "role": "anonymous",
                    "actions": [
                        "*"
                    ]
                }
            ],
            "mappings": {
                "Id": "Id",
                "SourceType": "SourceType",
                "SourceName": "SourceName",
                "SourceAccountId": "SourceAccountId",
                "TransactionDate": "TransactionDate",
                "PostDate": "PostDate",
                "Amount": "Amount",
                "Description": "Description",
                "Merchant": "Merchant",
                "OriginalCategory": "OriginalCategory",
                "TransactionType": "TransactionType",
                "CardNumber": "CardNumber",
                "RawCSVLine": "RawCSVLine",
                "SuggestedAccountId": "SuggestedAccountId",
                "SuggestedCategory": "SuggestedCategory",
                "SuggestedMemo": "SuggestedMemo",
                "ConfidenceScore": "ConfidenceScore",
                "Status": "Status",
                "ReviewedBy": "ReviewedBy",
                "ReviewedDate": "ReviewedDate",
                "ApprovedAccountId": "ApprovedAccountId",
                "ApprovedCategory": "ApprovedCategory",
                "ApprovedMemo": "ApprovedMemo",
                "JournalEntryId": "JournalEntryId",
                "CreatedDate": "CreatedDate"
            },
            "relationships": {
                "SourceAccount": {
                    "target.entity": "accounts",
                    "cardinality": "one",
                    "source.fields": [
                        "SourceAccountId"
                    ],
                    "target.fields": [
                        "Id"
                    ]
                },
                "SuggestedAccount": {
                    "target.entity": "accounts",
                    "cardinality": "one",
                    "source.fields": [
                        "SuggestedAccountId"
                    ],
                    "target.fields": [
                        "Id"
                    ]
                },
                "ApprovedAccount": {
                    "target.entity": "accounts",
                    "cardinality": "one",
                    "source.fields": [
                        "ApprovedAccountId"
                    ],
                    "target.fields": [
                        "Id"
                    ]
                },
                "JournalEntry": {
                    "target.entity": "journalentries",
                    "cardinality": "one",
                    "source.fields": [
                        "JournalEntryId"
                    ],
                    "target.fields": [
                        "Id"
                    ]
                }
            },
            "key-fields": [
                "Id"
            ]
        },
        "journalentries": {
            "source": "dbo.JournalEntries",
            "permissions": [
                {
                    "role": "anonymous",
                    "actions": [
                        "*"
                    ]
                }
            ]
        },
        "customers": {
            "source": "dbo.Customers",
            "permissions": [
                {
                    "role": "anonymous",
                    "actions": [
                        "*"
                    ]
                }
            ],
            "mappings": {
                "Id": "Id",
                "Name": "Name",
                "Email": "Email",
                "Phone": "Phone",
                "Address": "Address",
                "CreatedAt": "CreatedAt",
                "UpdatedAt": "UpdatedAt"
            },
            "key-fields": [
                "Id"
            ]
        },
        "invoices": {
            "source": "dbo.v_Invoices",
            "permissions": [
                {
                    "role": "anonymous",
                    "actions": [
                        "*"
                    ]
                }
            ],
            "mappings": {
                "Id": "Id",
                "InvoiceNumber": "InvoiceNumber",
                "CustomerId": "CustomerId",
                "IssueDate": "IssueDate",
                "DueDate": "DueDate",
                "TotalAmount": "TotalAmount",
                "Status": "Status"
            },
            "relationships": {
                "Customer": {
                    "target.entity": "customers",
                    "cardinality": "one",
                    "source.fields": [
                        "CustomerId"
                    ],
                    "target.fields": [
                        "Id"
                    ]
                },
                "Lines": {
                    "target.entity": "invoicelines",
                    "cardinality": "many",
                    "source.fields": [
                        "Id"
                    ],
                    "target.fields": [
                        "InvoiceId"
                    ]
                }
            },
            "key-fields": [
                "Id"
            ]
        },
        "invoicelines": {
            "source": "dbo.InvoiceLines",
            "permissions": [
                {
                    "role": "anonymous",
                    "actions": [
                        "*"
                    ]
                }
            ],
            "mappings": {
                "Id": "Id",
                "InvoiceId": "InvoiceId",
                "Description": "Description",
                "Quantity": "Quantity",
                "UnitPrice": "UnitPrice",
                "Amount": "Amount",
                "CreatedAt": "CreatedAt",
                "UpdatedAt": "UpdatedAt"
            },
            "relationships": {
                "Invoice": {
                    "target.entity": "invoices",
                    "cardinality": "one",
                    "source.fields": [
                        "InvoiceId"
                    ],
                    "target.fields": [
                        "Id"
                    ]
                }
            },
            "key-fields": [
                "Id"
            ]
        }
    }
}